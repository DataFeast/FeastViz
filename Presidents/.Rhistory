df_incomes <- read.csv("https://raw.githubusercontent.com/DataFeast71/Data_explorations/main/Salaries_HeadGovernment/data/Presidents_data_clean.csv", header = TRUE, stringsAsFactors = FALSE)
head(df_incomes)
library(tidyverse)
library(showtext)
library(ggsci)
library(patchwork)
df_world_tile <- read_csv("https://gist.githubusercontent.com/maartenzam/787498bbc07ae06b637447dbd430ea0a/raw/9a9dafafb44d8990f85243a9c7ca349acd3a0d07/worldtilegrid.csv") %>%
mutate(
## Namibias two-digit country code is handled as `NA`
alpha = if_else(name == "Namibia", "NA", alpha.2),
## We are oing to split America into "North" and South"
region = if_else(region == "Americas", sub.region, region),
region = if_else(region %in% c("Northern America", "Central America", "Caribbean"), "North America", region),
region = if_else(region == "Southern America", "South America", region),
## to join both data set, we need a Id column
country_code = alpha.3
)
head(df_world_tile)
setdiff(df_incomes$Country, df_world_tile$name)
df_all <- df_incomes %>%
full_join(df_world_tile, by = c("Country" = "name")) %>%
filter(!is.na(region), !is.na(HeadOfState)) %>%
group_by(region) %>%
mutate(president_income_median = median(HeadOfState, na.rm = TRUE)) %>%
ungroup()
df_president <- df_all %>%
select(Country, HeadOfState, Status, Continent, region, president_income_median)
head(df_president)
g <- ggplot(df_sorted, aes(x = region, y = HeadOfState, color = region)) +
coord_flip() +
scale_y_continuous(trans = "log10", limits = c(1e3,1.5e10), labels = scales::dollar, expand = c(0.005, 0.005)) +
scale_color_manual(values = c("#005eb4", "#d30080", "#ffcf00", "#ff6e00", "#ff0015", "#00a63d")) +
labs(x = NULL, y = "Head of State incomes") +
theme(
legend.position = "none",
plot.title = element_text(size = 20, family = "Roboto Mono"),
axis.title = element_text(size = 16),
axis.text.x = element_text(family = "Roboto Mono", size = 12),
panel.grid = element_blank()
)
df_sorted <- df_president %>%
mutate(region = fct_reorder(region, -president_income_median))
g <- ggplot(df_sorted, aes(x = region, y = HeadOfState, color = region)) +
coord_flip() +
scale_y_continuous(trans = "log10", limits = c(1e3,1.5e10), labels = scales::dollar, expand = c(0.005, 0.005)) +
scale_color_manual(values = c("#005eb4", "#d30080", "#ffcf00", "#ff6e00", "#ff0015", "#00a63d")) +
labs(x = NULL, y = "Head of State incomes") +
theme(
legend.position = "none",
plot.title = element_text(size = 20, family = "Roboto Mono"),
axis.title = element_text(size = 16),
axis.text.x = element_text(family = "Roboto Mono", size = 12),
panel.grid = element_blank()
)
